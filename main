import logging
import re
from datetime import datetime, timedelta
from functools import wraps

from telegram import Update, ChatPermissions
from telegram.constants import ParseMode
from telegram.ext import (
    Application,
    CommandHandler,
    MessageHandler,
    filters,
    ContextTypes,
)

# ---------- –ù–ê–°–¢–†–û–ô–ö–ò ----------
# –í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç @BotFather
BOT_TOKEN = "8766957616:AAFGEmx8pwOBtL_hEuIZOne_6Zho6jSIvo0"

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–∫–∞–∑–∞–Ω–∏—è
WARN_LIMIT = 3

# –í—Ä–µ–º—è –º—É—Ç–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –≤–∞—Ä–Ω–æ–≤ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
MUTE_DURATION = 86400  # 24 —á–∞—Å–∞

# ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã (–µ—Å–ª–∏ None, —Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–æ–ª—å –≤ —á–∞—Ç–µ)
ADMIN_IDS = None  # –∏–ª–∏ [123456789, 987654321]

# ---------- –õ–û–ì–ò–†–û–í–ê–ù–ò–ï ----------
logging.basicConfig(
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s", level=logging.INFO
)
logger = logging.getLogger(__name__)

# ---------- –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ----------
async def is_admin(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int = None) -> bool:
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —á–∞—Ç–∞ (–∏–ª–∏ –µ—Å—Ç—å –≤ —Å–ø–∏—Å–∫–µ ADMIN_IDS)."""
    if user_id is None:
        user_id = update.effective_user.id

    # –ï—Å–ª–∏ –∑–∞–¥–∞–Ω —Å–ø–∏—Å–æ–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤, –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ –Ω–µ–º—É
    if ADMIN_IDS is not None:
        return user_id in ADMIN_IDS

    # –ò–Ω–∞—á–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ —á–∞—Ç–µ
    chat_id = update.effective_chat.id
    try:
        member = await context.bot.get_chat_member(chat_id, user_id)
        return member.status in ("administrator", "creator")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤: {e}")
        return False

def admin_only(func):
    """–î–µ–∫–æ—Ä–∞—Ç–æ—Ä, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–∞–Ω–¥–µ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º."""
    @wraps(func)
    async def wrapper(update: Update, context: ContextTypes.DEFAULT_TYPE):
        if not await is_admin(update, context):
            await update.message.reply_text("‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.")
            return
        return await func(update, context)
    return wrapper

def get_warns_key(chat_id, user_id):
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª—é—á –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤ bot_data."""
    return f"warns_{chat_id}_{user_id}"

# ---------- –ö–û–ú–ê–ù–î–´ ----------
@admin_only
async def mute(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ó–∞–º—É—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Ç–≤–µ—Ç–æ–º –Ω–∞ –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–µ). –í—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)."""
    if not update.message.reply_to_message:
        await update.message.reply_text("‚ö†Ô∏è –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–º—É—Ç–∏—Ç—å.")
        return

    user_id = update.message.reply_to_message.from_user.id
    chat_id = update.effective_chat.id

    # –†–∞–∑–±–∏—Ä–∞–µ–º –≤—Ä–µ–º—è (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ)
    duration_minutes = 10  # –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    if context.args:
        try:
            duration_minutes = int(context.args[0])
        except ValueError:
            await update.message.reply_text("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏. –£–∫–∞–∂–∏—Ç–µ —á–∏—Å–ª–æ –º–∏–Ω—É—Ç.\n–ü—Ä–∏–º–µ—Ä: /–º—É—Ç 30")
            return

    until_date = datetime.now() + timedelta(minutes=duration_minutes)
    permissions = ChatPermissions(can_send_messages=False)

    try:
        await context.bot.restrict_chat_member(
            chat_id, user_id, permissions, until_date=until_date
        )
        await update.message.reply_text(
            f"üîá –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–º—É—á–µ–Ω –Ω–∞ {duration_minutes} –º–∏–Ω."
        )
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –º—É—Ç–∞: {e}")
        await update.message.reply_text("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–º—É—Ç–∏—Ç—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞.")

@admin_only
async def ban(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ó–∞–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Ç–≤–µ—Ç–æ–º –Ω–∞ –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–µ)."""
    if not update.message.reply_to_message:
        await update.message.reply_text("‚ö†Ô∏è –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±–∞–Ω–∏—Ç—å.")
        return

    user_id = update.message.reply_to_message.from_user.id
    chat_id = update.effective_chat.id

    try:
        await context.bot.ban_chat_member(chat_id, user_id)
        await update.message.reply_text("üö´ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–∞–Ω–µ–Ω.")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –±–∞–Ω–∞: {e}")
        await update.message.reply_text("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–±–∞–Ω–∏—Ç—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞.")

@admin_only
async def warn(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–í—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (–æ—Ç–≤–µ—Ç–æ–º). –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ ‚Äî –º—É—Ç."""
    if not update.message.reply_to_message:
        await update.message.reply_text("‚ö†Ô∏è –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–º—É —Ö–æ—Ç–∏—Ç–µ –≤—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.")
        return

    user_id = update.message.reply_to_message.from_user.id
    chat_id = update.effective_chat.id
    key = get_warns_key(chat_id, user_id)

    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫
    warns = context.bot_data.get(key, 0) + 1
    context.bot_data[key] = warns

    await update.message.reply_text(f"‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ {warns}/{WARN_LIMIT}.")

    if warns >= WARN_LIMIT:
        # –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç - –º—É—Ç–∏–º
        until_date = datetime.now() + timedelta(seconds=MUTE_DURATION)
        permissions = ChatPermissions(can_send_messages=False)
        try:
            await context.bot.restrict_chat_member(
                chat_id, user_id, permissions, until_date=until_date
            )
            await update.message.reply_text(
                f"üîá –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª {WARN_LIMIT} –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –∏ –∑–∞–º—É—á–µ–Ω –Ω–∞ {MUTE_DURATION//3600} —á."
            )
            # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –ø–æ—Å–ª–µ –Ω–∞–∫–∞–∑–∞–Ω–∏—è (–∏–ª–∏ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏)
            context.bot_data.pop(key, None)
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º—É—Ç–∞: {e}")
            await update.message.reply_text("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–º—É—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∑–∞—Å—á–∏—Ç–∞–Ω–æ.")

@admin_only
async def unmute(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–°–Ω—è—Ç—å –º—É—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Ç–≤–µ—Ç–æ–º)."""
    if not update.message.reply_to_message:
        await update.message.reply_text("‚ö†Ô∏è –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ —Å–Ω—è—Ç—å –º—É—Ç.")
        return

    user_id = update.message.reply_to_message.from_user.id
    chat_id = update.effective_chat.id

    # –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ (—Ä–∞–∑—Ä–µ—à–∞–µ–º –≤—Å—ë)
    permissions = ChatPermissions(
        can_send_messages=True,
        can_send_media_messages=True,
        can_send_polls=True,
        can_send_other_messages=True,
        can_add_web_page_previews=True,
        can_change_info=True,
        can_invite_users=True,
        can_pin_messages=True,
    )

    try:
        await context.bot.restrict_chat_member(chat_id, user_id, permissions)
        await update.message.reply_text("üîä –ú—É—Ç —Å–Ω—è—Ç.")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ —Å–Ω—è—Ç–∏—è –º—É—Ç–∞: {e}")
        await update.message.reply_text("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–Ω—è—Ç—å –º—É—Ç.")

@admin_only
async def unban(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–†–∞–∑–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Ç–≤–µ—Ç–æ–º)."""
    if not update.message.reply_to_message:
        await update.message.reply_text("‚ö†Ô∏è –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–±–∞–Ω–∏—Ç—å.")
        return

    user_id = update.message.reply_to_message.from_user.id
    chat_id = update.effective_chat.id

    try:
        await context.bot.unban_chat_member(chat_id, user_id, only_if_banned=True)
        await update.message.reply_text("‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–±–∞–Ω–µ–Ω.")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ —Ä–∞–∑–±–∞–Ω–∞: {e}")
        await update.message.reply_text("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–±–∞–Ω–∏—Ç—å.")

@admin_only
async def add_word(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ –≤ —Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö."""
    if not context.args:
        await update.message.reply_text("–£–∫–∞–∂–∏—Ç–µ —Å–ª–æ–≤–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è.\n–ü—Ä–∏–º–µ—Ä: /–¥–æ–±–∞–≤–∏—Ç—å—Å–ª–æ–≤–æ —Å–ø–∞–º")
        return

    word = " ".join(context.args).lower().strip()
    bad_words = context.bot_data.setdefault("bad_words", set())

    if word in bad_words:
        await update.message.reply_text(f"–°–ª–æ–≤–æ ¬´{word}¬ª —É–∂–µ –≤ —Å–ø–∏—Å–∫–µ.")
    else:
        bad_words.add(word)
        await update.message.reply_text(f"–°–ª–æ–≤–æ ¬´{word}¬ª –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö.")

@admin_only
async def remove_word(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–£–¥–∞–ª–∏—Ç—å —Å–ª–æ–≤–æ –∏–∑ —Å–ø–∏—Å–∫–∞ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö."""
    if not context.args:
        await update.message.reply_text("–£–∫–∞–∂–∏—Ç–µ —Å–ª–æ–≤–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.\n–ü—Ä–∏–º–µ—Ä: /—É–¥–∞–ª–∏—Ç—å—Å–ª–æ–≤–æ —Å–ø–∞–º")
        return

    word = " ".join(context.args).lower().strip()
    bad_words = context.bot_data.get("bad_words", set())

    if word in bad_words:
        bad_words.remove(word)
        await update.message.reply_text(f"–°–ª–æ–≤–æ ¬´{word}¬ª —É–¥–∞–ª–µ–Ω–æ –∏–∑ —Å–ø–∏—Å–∫–∞.")
    else:
        await update.message.reply_text(f"–°–ª–æ–≤–æ ¬´{word}¬ª –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ —Å–ø–∏—Å–∫–µ.")

@admin_only
async def list_words(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤."""
    bad_words = context.bot_data.get("bad_words", set())
    if not bad_words:
        await update.message.reply_text("–°–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤ –ø—É—Å—Ç.")
        return

    words_list = "\n".join(sorted(bad_words))
    await update.message.reply_text(f"üìã –ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–ª–æ–≤–∞:\n{words_list}")

# ---------- –ê–í–¢–û–£–î–ê–õ–ï–ù–ò–ï –°–û–û–ë–©–ï–ù–ò–ô ----------
async def auto_delete(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–£–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–ª–æ–≤–∞."""
    if not update.message or not update.message.text:
        return

    # –ù–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã (—á—Ç–æ–±—ã –Ω–µ —É–¥–∞–ª—è—Ç—å /addword –∏ —Ç.–ø.)
    if update.message.text.startswith("/"):
        return

    chat_id = update.effective_chat.id
    user_id = update.effective_user.id
    text = update.message.text.lower()

    bad_words = context.bot_data.get("bad_words", set())
    if not bad_words:
        return

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ª—é–±–æ–≥–æ –∏–∑ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ
    for word in bad_words:
        # –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –ø–æ–∏—Å–∫ (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ regex —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ —Å–ª–æ–≤)
        if word in text:
            try:
                await update.message.delete()
                logger.info(f"–£–¥–∞–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {user_id} (—Å–ª–æ–≤–æ: {word})")
                # –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ —á–∞—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                # await context.bot.send_message(chat_id, f"‚ö†Ô∏è –°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ –∏–∑-–∑–∞ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞.")
            except Exception as e:
                logger.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ: {e}")
            break

# ---------- –ó–ê–ü–£–°–ö ----------
def main():
    """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞."""
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
    if BOT_TOKEN == "–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê":
        logger.error("–¢–æ–∫–µ–Ω –Ω–µ –∑–∞–¥–∞–Ω! –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é BOT_TOKEN –≤ –∫–æ–¥–µ.")
        return

    # –°–æ–∑–¥–∞—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = Application.builder().token(BOT_TOKEN).build()

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤ (–º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å –ø—É—Å—Ç–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞)
    application.bot_data["bad_words"] = set()

    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ —Å —Ä—É—Å—Å–∫–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
    # –†—É—Å—Å–∫–∏–µ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –≤–µ—Ä—Å–∏–∏ –∫–æ–º–∞–Ω–¥
    application.add_handler(CommandHandler(["mute", "–º—É—Ç"], mute))
    application.add_handler(CommandHandler(["ban", "–±–∞–Ω"], ban))
    application.add_handler(CommandHandler(["warn", "–≤–∞—Ä–Ω"], warn))
    application.add_handler(CommandHandler(["unmute", "—Ä–∞–∑–º—É—Ç"], unmute))
    application.add_handler(CommandHandler(["unban", "—Ä–∞–∑–±–∞–Ω"], unban))
    application.add_handler(CommandHandler(["addword", "–¥–æ–±–∞–≤–∏—Ç—å—Å–ª–æ–≤–æ"], add_word))
    application.add_handler(CommandHandler(["removeword", "—É–¥–∞–ª–∏—Ç—å—Å–ª–æ–≤–æ"], remove_word))
    application.add_handler(CommandHandler(["words", "—Å–ª–æ–≤–∞"], list_words))

    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏—è (–ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥, —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥—ã –Ω–µ —É–¥–∞–ª—è–ª–∏—Å—å)
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, auto_delete))

    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞ (polling)
    logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    application.run_polling()

if __name__ == "__main__":
    main()
